<html>

<head>
	<style>
		@keyframes pulse {
			0% {
				box-shadow: 0px 0px 0px 1px rgba(165, 165, 165, 0.04),
							-9px 9px 9px -0.5px rgba(0, 0, 0, 0.04),
							-18px 18px 18px -1.5px rgba(0, 0, 0, 0.08),
							-37px 37px 37px -3px rgba(0, 0, 0, 0.16),
							-75px 75px 75px -6px rgba(0, 0, 0, 0.24),
							-150px 150px 150px -12px rgba(0, 0, 0, 0.48);
			}
			50% {
				box-shadow: 0px 0px 0px 1px rgba(165, 165, 165, 0.05),
							-9px 9px 9px -0.5px rgba(0, 0, 0, 0.05),
							-18px 18px 18px -1.5px rgba(0, 0, 0, 0.10),
							-37px 37px 37px -3px rgba(0, 0, 0, 0.18),
							-75px 75px 75px -6px rgba(0, 0, 0, 0.26),
							-150px 150px 150px -12px rgba(0, 0, 0, 0.50);
			}
			100% {
				box-shadow: 0px 0px 0px 1px rgba(165, 165, 165, 0.04),
							-9px 9px 9px -0.5px rgba(0, 0, 0, 0.04),
							-18px 18px 18px -1.5px rgba(0, 0, 0, 0.08),
							-37px 37px 37px -3px rgba(0, 0, 0, 0.16),
							-75px 75px 75px -6px rgba(0, 0, 0, 0.24),
							-150px 150px 150px -12px rgba(0, 0, 0, 0.48);
			}
		}

		html{ 
			background: rgb(48, 49, 56);
			/*background: linear-gradient(215deg, rgba(68,73,106,1) 0%, rgba(53,140,121,1) 34%, rgba(49,68,71,1) 100%); */
            padding: 15px;
		}
		body {
            font-family: 'Consolas', monospace;
			height: 100%;
			margin: 0;
			display: flex;
			justify-content: center;
			align-items: center;
		}



        
        .hidden{
            transition: all 1s ease-in-out !important;
            opacity:0;
            max-height:0;
            max-width:0;
            display:none;
            padding:0 !important;
            margin:0 !important;
            border:none !important;
            overflow:hidden;
        }
        .disable-selectt {
            user-select: none; /* supported by Chrome and Opera */
            -webkit-user-select: none; /* Safari */
            -khtml-user-select: none; /* Konqueror HTML */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            -webkit-user-drag: none;
        }



        
        /*Rounded elment*/ 
		.rounded-element {
			/*width: calc(60vw); 
			border-radius: 15px;  
			background: linear-gradient(195deg, #715555, #536176);  
			padding: 20px;  
			color: #ffffff; 
			animation: pulse 3s infinite; */

            position: absolute;
            top: 15px;
			color: #ffffff; 
            max-width: 600px; 
            border-radius: 15px;
            padding: 15px;
			background: linear-gradient(195deg, #534242, #536176);  
            border-radius: 15px; 

		}

        /*Drop down*/
        .dropdown select {
            width: 260px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 16px;
            appearance: none;
            font-family: 'Consolas', monospace; 
            background-color: #fff;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIj48cGF0aCBkPSJNNSAxMmw3IDcgNy03Ii8+PC9zdmc+');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }
        
        .dropdown select:focus {
            border-color: #007BFF;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
            outline: none;
        }

        #demoCanvasContainer{
            text-align: center;
        }


        h1{
            font-size: 48px;
        }

        a{
            color: #8febff;
        }

        .info-section{
            width: 100%;
			border-radius: 15px; /* Adjust the value to control the roundness */
            border: 1px rgb(38, 176, 98) solid;
        }
        .todo-section{
            width: 100%;
			border-radius: 15px; /* Adjust the value to control the roundness */
            border: 1px rgb(198, 190, 36) solid;
        }

        /* Cod eeditor*/
        .code-editor-container {
            width: 600px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #361414;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #007BFF;
            color: white;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }
        
        .editor-header button {
            background-color: white;
            color: #007BFF;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .editor-header button:hover {
            background-color: #e0e0e0;
        }
        
        .editor {
            display: flex;
            font-family: 'Consolas', monospace;
            height: 300px;
        }
        
        .line-numbers {
            padding: 10px;
            background-color: #f7f7f7;
            border-right: 1px solid #ccc;
            user-select: none;
            color: #999;
            text-align: right;
        }
        
        .line-numbers div {
            line-height: 20px;
        }
        
        textarea {
            width: 100%;
            padding: 10px;
            border: none;
            resize: none;
            outline: none;
            font-family: 'Consolas', monospace;
            line-height: 20px;
            overflow: auto;
        }

        #extraTitle{
            color: rgb(238, 208, 40)
        }
	</style>
    <script>
        var htmlInject0 = `
        
        `;
    </script>
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<title>EzWebGPU.js</title>

    <!-- <script src="src/PseudRand.js"></script> -->
    <script src="src/EZWG.js"></script>
</head>


<body>
	
	<div class="rounded-element"> 
        <div href="https://github.com/bonisdev">
            <!--I think this racing stripe looks pretty sharp-->
            <h1><span style="color: aqua;padding-left: 2px;border-left: 4px solid rgb(234, 31, 31);">EZ</span><span style="color: #0093FF;border-bottom: 4px solid rgb(31, 200, 28);">Web</span><span style="color: #0093FF;border-top: 4px solid rgb(236, 218, 21);">GPU</span><span style="color: aliceblue;border-right: 4px solid rgb(244, 117, 14);padding-right: 2px;">.js</span></h1>
        
        </div> 

        <div style="max-width: 70%;">
            <p>EzWebGPU is a wrapper for <a href="https://www.w3.org/TR/webgpu/">WebGPU</a> which handles setting up a read and write buffer pair to quickly write, deploy, and visually debug compute shaders very painlessly.  You can quickly setup cellular automata simulations and get <span style="color: rgb(241, 92, 179);font-style: bold;">TRILLIONS</span> of FLOPS all in the browser.  See on: <a href="https://github.com/bonisdev">GitHub</a></p>
        </div>
        <h2 style="color: rgb(38, 176, 98);">WHAT:</h2>
        <div class="info-section">
            <ul>
                <li> Run a compute shader on a grid of cells's using the first available GPU device </li>
                <li> Handles setup for a read/write buffer pair, useful for highly customizable cellular automatas </li>
                <li> Has a list of <a href="https://github.com/bonisdev">pre computed constants</a> to increase the <a href="https://www.w3.org/TR/WGSL/">WGSL</a> readability </li>
                <li> Get the memory buffers back from the GPU to the CPU (Javascript f32 buffer) </li>
                <li> Load static buffers for the shader program to read while inside the GPU </li>
            </ul>
        </div>
        
        

		<p>Examples (<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGPU_API#browser_compatibility">Must have chrome</a>):</p>
        <div class="dropdown">
            <select id="dropdown" onchange="handleSelectChange(this.value)">
                <option value="0">Standard CGOL</option>
                <option value="1">Quadrant CGOL</option>
                <option value="2">Multi-Part Renderer</option>
                <option value="3">Storage Buffer</option>
                <option value="4">GPU Buffer Readback</option>
                <option value="5">Multi-Value CGOL</option>
                <option value="6">Mouse Input</option>
            </select>
        </div>
        <br>

        
        <div id="demoCanvasContainer"></div>
        <br>
        <div id="extraTitle"></div>

        <br>
        <!--  Use this:  https://highlight.hohli.com/?language=rust&theme=a11y-dark&numbers=1 -->
        <div id="exampleCode0">
            <pre style="font-family:monospace;color: rgb(248, 248, 242); background-color: rgb(43, 43, 43); font-weight: 400; "><ol style="padding-left: 3em;"><li><span style="color: rgb(220, 198, 224); font-weight: 400;">let</span> <span style="color: rgb(255, 160, 122); font-weight: 400;">computeWGSL</span> = </li><li>`</li><li>    var neighbs: <span style="color: rgb(245, 171, 53); font-weight: 400;">f32</span> = <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>;</li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );      </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY  , <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );      </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );     </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX  , EZY-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );    </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );   </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY  , <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );     </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX-<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, EZY+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );  </li><li>    neighbs += <span style="color: rgb(0, 224, 224); font-weight: 400;">EZ_GET_CELL</span>( EZX  , EZY+<span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>, <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>, EZ_CHUNK_X, EZ_CHUNK_Y );</li><li></li><li>    var myState: <span style="color: rgb(245, 171, 53); font-weight: 400;">f32</span> = EZ_STATE_IN[ EZ_CELL_IND ];</li><li></li><li>    <span style="color: rgb(220, 198, 224); font-weight: 400;">if</span> (myState == <span style="color: rgb(245, 171, 53); font-weight: 400;">1</span> &amp;&amp; (neighbs &lt; <span style="color: rgb(245, 171, 53); font-weight: 400;">2</span> || neighbs &gt; <span style="color: rgb(245, 171, 53); font-weight: 400;">3</span>)) {</li><li>        EZ_STATE_OUT[ EZ_CELL_IND ] = <span style="color: rgb(245, 171, 53); font-weight: 400;">0.0</span>;</li><li>    }</li><li>    <span style="color: rgb(220, 198, 224); font-weight: 400;">else</span> <span style="color: rgb(220, 198, 224); font-weight: 400;">if</span> (myState == <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span> &amp;&amp; neighbs == <span style="color: rgb(245, 171, 53); font-weight: 400;">3</span>) {</li><li>        EZ_STATE_OUT[ EZ_CELL_IND ] = <span style="color: rgb(245, 171, 53); font-weight: 400;">1.0</span>;</li><li>    }</li><li>    <span style="color: rgb(220, 198, 224); font-weight: 400;">else</span> {</li><li>        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;</li><li>    }</li><li>`;</li><li></li><li><span style="color: rgb(220, 198, 224); font-weight: 400;">let</span> <span style="color: rgb(255, 160, 122); font-weight: 400;">fragmentWGSL</span> = </li><li>`</li><li>    var rrr: <span style="color: rgb(245, 171, 53); font-weight: 400;">f32</span> = <span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>;</li><li>    var ggg: <span style="color: rgb(245, 171, 53); font-weight: 400;">f32</span> = <span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>;</li><li>    var bbb: <span style="color: rgb(245, 171, 53); font-weight: 400;">f32</span> = <span style="color: rgb(245, 171, 53); font-weight: 400;">1</span>; </li><li></li><li>    <span style="color: rgb(220, 198, 224); font-weight: 400;">if</span>( cellState[ EZ_REBUILT_INSTANCE + (<span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>) * <span style="color: rgb(0, 224, 224); font-weight: 400;">u32</span>(grid.x * grid.y) ] &lt; <span style="color: rgb(245, 171, 53); font-weight: 400;">1</span> ){</li><li>        rrr = <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>;</li><li>        ggg = <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>;</li><li>        bbb = <span style="color: rgb(245, 171, 53); font-weight: 400;">0</span>;</li><li>    }</li><li></li><li>    EZ_OUTPUT.red = rrr;</li><li>    EZ_OUTPUT.grn = ggg;</li><li>    EZ_OUTPUT.blu = bbb; </li><li>`;</li><li></li><li><span style="color: rgb(212, 208, 171); font-weight: 400;">// Usage example</span></li><li><span style="color: rgb(220, 198, 224); font-weight: 400;">let</span> <span style="color: rgb(255, 160, 122); font-weight: 400;">config</span> = {</li><li></li><li>    CELL_SIZE: <span style="color: rgb(245, 171, 53); font-weight: 400;">2</span>,</li><li>    CHUNK_SIZE: <span style="color: rgb(245, 171, 53); font-weight: 400;">256</span>,</li><li></li><li>    CONTAINER_ID:   <span style="color: rgb(171, 227, 56); font-weight: 400;">'demoCanvasContainer</span>',    <span style="color: rgb(212, 208, 171); font-weight: 400;">// DOM id to insdert canvas to</span></li><li>    RAND_SEED:      <span style="color: rgb(171, 227, 56); font-weight: 400;">'randomseed12345678910</span>', </li><li>    STARTING_CONFIG: EZWG.ALL_BINS,      <span style="color: rgb(212, 208, 171); font-weight: 400;">// couldve been EZWG.ALL_ZERO</span></li><li>    COMPUTE_WGSL: `</li><li>        <span style="color: rgb(212, 208, 171); font-weight: 400;">// The custom WGSL code goes here</span></li><li>        ${computeWGSL}</li><li>    `,</li><li></li><li>    FRAGMENT_WGSL: `</li><li>        <span style="color: rgb(212, 208, 171); font-weight: 400;">// The custom WGSL code goes here</span></li><li>        ${fragmentWGSL}</li><li>    `</li><li>};</li><li></li><li><span style="color: rgb(212, 208, 171); font-weight: 400;">// Intital set the default runner to this</span></li><li>EZ_EXAMPLE = new <span style="color: rgb(0, 224, 224); font-weight: 400;">EZWG</span>( config);</li></ol></pre>
        </div>

        <br>

        <h2 style="color: rgb(198, 190, 36);">TODO:</h2>
            <div class="todo-section">
                <ul>
                    <li> Add U32 buffer types (currently only F32) </li>
                    <li> Ability to edit the shader compute pipeline </li>
                    <li> Custom vertices (instead of just squares) </li>
                    <li> UI grid editor </li>
                    <li> Add more examples (send here: <a href="https://twitter.com/BonisDev">@BonisDev</a>) </li>
            </ul>
        </div>



        <!--Code-->
        <div class="code-editor-container">
            <!-- <div class="editor-header">
                <span>Code Editor</span>
                <button id="copyButton">Copy to clipboard</button>
            </div>
            <div class="editor">
                <div class="line-numbers" id="lineNumbers"></div>
                <textarea id="codeEditor" spellcheck="false"></textarea>
            </div> -->

        <p style="color: rgb(172, 31, 129);">How it works:</p>
        <div class="info-section">
            <ul>
                <li>Some kind of diagram</li> 
            </ul>
        </div>
    
        
	</div>
	
    <script>
        var EZ_EXAMPLE = null
        var INTERVAL_ID = null

        function handleSelectChange(value) {
            loadExample( Number(value) )
        }
        
        function yourFunction(value) {
            // Replace this with your actual function logic
            alert('You selected: ' + value);
        }

        


        document.addEventListener("DOMContentLoaded", function() {
            // const codeEditor = document.getElementById("codeEditor");
            // const lineNumbers = document.getElementById("lineNumbers");
            // const copyButton = document.getElementById("copyButton");
        
            // codeEditor.addEventListener("input", updateLineNumbers);
            // codeEditor.addEventListener("scroll", () => {
            //     lineNumbers.scrollTop = codeEditor.scrollTop;
            // });
        
            // copyButton.addEventListener("click", copyToClipboard);
        
            // function updateLineNumbers() {
            //     const lines = codeEditor.value.split('\n').length;
            //     lineNumbers.innerHTML = Array(lines).fill(0).map((_, i) => `<div>${i + 1}</div>`).join('');
            // }
        
            // function copyToClipboard() {
            //     codeEditor.select();
            //     document.execCommand("copy");
            //     alert("Code copied to clipboard!");
            // }
        
            // // Initialize line numbers
            // updateLineNumbers();
        });



        
        

    </script>

    <script>

        const ALL_EXAMPLES = [

        // 1 (ONE) - Standard Conway Game of Life
        () => {
                let computeWGSL = 
                `
                    var neighbs: f32 = 0;
                    neighbs += EZ_GET_CELL(EZX+1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX+1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX+1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX  , EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX-1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX-1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX-1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );
                    neighbs += EZ_GET_CELL(EZX  , EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );

                    var myState: f32 = EZ_STATE_IN[ EZ_CELL_IND ];

                    
                    if (myState == 1 && (neighbs < 2 || neighbs > 3)) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 0.0;
                    }
                    else if (myState == 0 && neighbs == 3) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 1.0;
                    }
                    else {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;
                    }
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 0;
                    var ggg: f32 = 0;
                    var bbb: f32 = 0;

                    var cellVal: f32 = cellState[ EZ_REBUILT_INSTANCE + (0) * EZ_TOTAL_CELLS ];

                    if( cellVal < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{
                        rrr = 1;
                        ggg = 1;
                        bbb = 1;
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb; 
                `;

                // Usage example
                let config = {

                    CELL_SIZE: 2,
                    CHUNK_SIZE: 256,
                    CHUNKS_ACROSS: 1,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);

                document.getElementById('extraTitle').innerHTML = 
                `
                    <p style="color: red;">For some reason CHUNK_SIZE 256 results in this flashing...  255 and 257 work fine again</p>
                `;
            },
        // 2 (TWO) - Standard Conway Game of Life (QUADRANTS)
            () => {
                let computeWGSL = 
                `
                    var neighbs: f32 = 0;
                    neighbs += EZ_GET_CELL(EZX+1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX  , EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );    
                    neighbs += EZ_GET_CELL(EZX-1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );   
                    neighbs += EZ_GET_CELL(EZX-1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX-1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );  
                    neighbs += EZ_GET_CELL(EZX  , EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );       

                    var myState: f32 = EZ_STATE_IN[ EZ_CELL_IND ];

                    
                    if (myState == 1 && (neighbs < 2 || neighbs > 3)) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 0.0;
                    }
                    else if (myState == 0 && neighbs == 3) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 1.0;
                    }
                    else {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;
                    }
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 1;
                    var ggg: f32 = 1;
                    var bbb: f32 = 0;

                    var cellVal: f32 = cellState[ EZ_REBUILT_INSTANCE + (0) * EZ_TOTAL_CELLS ];

                    if( cellVal < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{
                        if(EZ_CHUNK_X == 0 && EZ_CHUNK_Y == 0 ){
                            rrr = 1;
                            ggg = 0;
                            bbb = 0;
                        }
                        else if(EZ_CHUNK_X == 1 && EZ_CHUNK_Y == 0 ){
                            rrr = 0;
                            ggg = 1;
                            bbb = 0;
                        }
                        else if(EZ_CHUNK_X == 0 && EZ_CHUNK_Y == 1 ){
                            rrr = 0;
                            ggg = 0;
                            bbb = 1;
                        }
                        else if(EZ_CHUNK_X == 1 && EZ_CHUNK_Y == 1 ){
                            rrr = 1;
                            ggg = 1;
                            bbb = 0;
                        }
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb; 
                `;

                // Usage example
                let config = {

                    CELL_SIZE: 2,
                    CHUNK_SIZE: 128,
                    CHUNKS_ACROSS: 2,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },
        // 3 (THREE) - Standard Conway Game of Life (QUADRANTS + COMPONENT)
            () => {
                let computeWGSL = 
                `
                    var neighbs: f32 = 0;
                    neighbs += EZ_GET_CELL(EZX+1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX  , EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );    
                    neighbs += EZ_GET_CELL(EZX-1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );   
                    neighbs += EZ_GET_CELL(EZX-1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX-1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );  
                    neighbs += EZ_GET_CELL(EZX  , EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );       

                    var myState: f32 = EZ_STATE_IN[ EZ_CELL_IND ];

                    if (myState == 1 && (neighbs < 2 || neighbs > 3)) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 0.0;
                    }
                    else if (myState == 0 && neighbs == 3) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 1.0;
                    }
                    else {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;
                    }
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 1;
                    var ggg: f32 = 1;
                    var bbb: f32 = 0;

                    var cellVal: f32 = cellState[ EZ_REBUILT_INSTANCE + (0) * EZ_TOTAL_CELLS ];

                    if( cellVal < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{

                        // Calc distance 
                        var distFromCenter: f32 = abs( EZ_PARTS_ACROSS_F/2f - f32(EZ_COMP_X) );
                        distFromCenter = abs( distFromCenter + ((EZ_PARTS_ACROSS_F/2f)-f32(EZ_COMP_Y)) ) ;
                        distFromCenter = distFromCenter / ( EZ_PARTS_ACROSS_F );

                        let offR = 0.44 + (f32(EZ_CHUNK_X) * 0.913 + f32(EZ_CHUNK_Y) * 0.7121) % 1;
                        let offG = 0.78 + (f32(EZ_CHUNK_X) * 0.513 + f32(EZ_CHUNK_Y) * 0.8121) % 1;
                        let offB = 0.41 + (f32(EZ_CHUNK_X) * 0.693 + f32(EZ_CHUNK_Y) * 0.4121) % 1;

                        rrr = offR * (1f - distFromCenter);
                        ggg = offG * (1f - distFromCenter);
                        bbb = offB * (1f - distFromCenter);
                        

                        
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb; 
                `;

                // Usage example
                let config = {

                    CELL_SIZE: 8,
                    CHUNK_SIZE: 32,
                    CHUNKS_ACROSS: 2,
                    PARTS_ACROSS: 8,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },
        // 4 (FOUR) - Random Colour Game of Life (QUADRANTS + COMPONENTS + FADING core)
            // + residual cool down 
            () => {
                let computeWGSL = 
                `
                    var neighbs: f32 = 0;
                    neighbs += EZ_GET_CELL(EZX+1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX  , EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );    
                    neighbs += EZ_GET_CELL(EZX-1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );   
                    neighbs += EZ_GET_CELL(EZX-1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX-1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );  
                    neighbs += EZ_GET_CELL(EZX  , EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );       

                    var myState: f32 = EZ_STATE_IN[ EZ_CELL_IND ];

                    if (myState == 1 && (neighbs < 2 || neighbs > 3)) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 0.0;
                    }
                    else if (myState == 0 && neighbs == 3) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 1.0;
                    }

                    else {

                        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;
                    }
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 1;
                    var ggg: f32 = 1;
                    var bbb: f32 = 0;

                    var cellVal: f32 = cellState[ EZ_REBUILT_INSTANCE + (0) * u32(grid.x * grid.y) ];

                    var drawingWeightsOffset: u32 = EZ_CHUNK_IND * 3u; // 3 storage values for r,g,b

                    if( cellVal < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{

                        rrr = EZ_STORAGE[ drawingWeightsOffset + 0 ];
                        ggg = EZ_STORAGE[ drawingWeightsOffset + 1 ];
                        bbb = EZ_STORAGE[ drawingWeightsOffset + 2 ];
                        
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb; 
                `;

                // An Extra buffer of random f32's 0-1 to get a variety of colours
                let randomConwayRGBs = new Float32Array( 256 );
                EZWG.SHA1.seed('test seed 1234' + Date.now());
                for(let b = 0;b < randomConwayRGBs.length;b++){ 
                    
                    randomConwayRGBs[b] = EZWG.SHA1.random()
                }
                console.log(randomConwayRGBs)

                // Usage example
                let config = {

                    CELL_SIZE: 5,
                    CHUNK_SIZE: 32,
                    CHUNKS_ACROSS: 3,
                    PARTS_ACROSS: 5,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `,

                    STORAGE: randomConwayRGBs

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },
        // 5 (FIVE) - Read Back multi val
            // + residual cool down  
            () => {
                let computeWGSL = 
                `
                    var neighbs: f32 = 0;
                    neighbs += EZ_GET_CELL(EZX+1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );      
                    neighbs += EZ_GET_CELL(EZX+1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX  , EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );    
                    neighbs += EZ_GET_CELL(EZX-1, EZY-1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );   
                    neighbs += EZ_GET_CELL(EZX-1, EZY  , 0, EZ_CHUNK_X, EZ_CHUNK_Y );     
                    neighbs += EZ_GET_CELL(EZX-1, EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );  
                    neighbs += EZ_GET_CELL(EZX  , EZY+1, 0, EZ_CHUNK_X, EZ_CHUNK_Y );       

                    var myState: f32 = EZ_STATE_IN[ EZ_CELL_IND ];

                    if (myState == 1 && (neighbs < 2 || neighbs > 3)) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 0.0;
                    }
                    else if (myState == 0 && neighbs == 3) {
                        EZ_STATE_OUT[ EZ_CELL_IND ] = 1.0;
                    }

                    else {

                        EZ_STATE_OUT[ EZ_CELL_IND ] = myState;
                    }
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 1;
                    var ggg: f32 = 1;
                    var bbb: f32 = 0;

                    var cellVal: f32 = cellState[ EZ_REBUILT_INSTANCE + (0) * u32(grid.x * grid.y) ];

                    var drawingWeightsOffset: u32 = EZ_CHUNK_IND * 3u; // 3 storage values for r,g,b

                    if( cellVal < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{

                        rrr = EZ_STORAGE[ drawingWeightsOffset + 0 ];
                        ggg = EZ_STORAGE[ drawingWeightsOffset + 1 ];
                        bbb = EZ_STORAGE[ drawingWeightsOffset + 2 ];
                        
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb; 
                `;

                // An Extra buffer of random f32's 0-1 to get a variety of colours
                let randomConwayRGBs = new Float32Array( 256 );
                EZWG.SHA1.seed('test seed 1234' + Date.now());
                for(let b = 0;b < randomConwayRGBs.length;b++){ 
                    
                    randomConwayRGBs[b] = EZWG.SHA1.random()
                }

                document.getElementById('extraTitle').innerHTML = 'Check the console.log for the buffer every 100 steps'

                // Usage example
                let config = {

                    CELL_SIZE: 5,
                    CHUNK_SIZE: 32,
                    CHUNKS_ACROSS: 3,
                    PARTS_ACROSS: 1,

                    READ_BACK_FREQ: 100,
                    READ_BACK_FUNC: ( currentStep, entireBuffer ) => { console.log('entireBuffer', entireBuffer.length); },

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `,

                    STORAGE: randomConwayRGBs

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },

        // 6 (SIX) - Neural Network ( with QUADRANTS) 
                //document.getElementById('extraTitle').innerHTML = 'Check the console.log for the buffer every 100 steps'
            () => {
                let computeWGSL = 
                `

                    // Helper variables for readability later on
                    var attributeOffset: u32 = 0;
                    var myState: f32 = 0;
                    var totalNghbrCount: u32 = 0;

                    // Loop through each value in the cell, and store their CGOL state value
                    var neighbrs: array< f32, EZ_CELL_VALS >;
                    var valIndex: u32 = 0;
                    loop {
                        if valIndex >= EZ_CELL_VALS { break; }
                        
                        neighbrs[ valIndex ] = 0f;
                        attributeOffset = valIndex*EZ_TOTAL_CELLS;

                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );      
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY  , valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );      
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );     
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX  , EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );    
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );   
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY  , valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );     
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );  
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX  , EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );

                        myState = EZ_STATE_IN[ EZ_CELL_IND + attributeOffset ];
                        totalNghbrCount = u32(neighbrs[ valIndex ]);

                        // Implement CGOL rules for this value in memory
                        if (myState == 1 && (totalNghbrCount < 2 || totalNghbrCount > 3)) {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = 0.0;
                        }
                        else if (myState == 0 && totalNghbrCount == 3) {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = 1.0;
                        }
                        else {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = myState;
                        }
                        
                        valIndex++;
                    }  


                    
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 0;
                    var ggg: f32 = 0;
                    var bbb: f32 = 0;

                    // Helper variables for readiblity
                    var drawingWeightsOffset: u32 = 0;
                    var cellVal: f32 = 0;
                    var totalTypesLive: u32 = EZ_CELL_VALS;
                    
                    var valIndex: u32 = 0;  //< - the attribute index in a cell
                    loop {
                        if valIndex >= EZ_CELL_VALS { break; }

                        // shift read location in storage buffer: 3 storage values for r,g,b
                        drawingWeightsOffset = EZ_CHUNK_IND * 3u;
                        // and also shift down the location to accomodate the multiple values per cell  
                        drawingWeightsOffset = drawingWeightsOffset + (EZ_CELL_VALS * 3u) * valIndex;

                        // Get the value
                        cellVal = cellState[ EZ_REBUILT_INSTANCE + valIndex * EZ_TOTAL_CELLS ];
                        if( cellVal < 1 ){
                            totalTypesLive = totalTypesLive - 1;
                        }
                        else{ 
                            rrr += EZ_STORAGE[ drawingWeightsOffset + 0 ];
                            ggg += EZ_STORAGE[ drawingWeightsOffset + 1 ];
                            bbb += EZ_STORAGE[ drawingWeightsOffset + 2 ]; 
                        }
                        valIndex++;
                    }

                    if( totalTypesLive < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{
                        rrr = rrr / f32(totalTypesLive);
                        ggg = ggg / f32(totalTypesLive);
                        bbb = bbb / f32(totalTypesLive);
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb;
                `;

                // An Extra buffer of random f32's 0-1 to get a variety of colours
                let randomConwayRGBs = new Float32Array( 4096 );
                EZWG.SHA1.seed('test seed 1234' + Date.now());
                for(let b = 0;b < randomConwayRGBs.length;b++){
                    randomConwayRGBs[b] = EZWG.SHA1.random()
                } 

                // Usage example
                let config = {

                    CELL_VALS: 8,   // Now this means 17 f32 values per cell
                    CELL_SIZE: 4,
                    CHUNK_SIZE: 32,
                    CHUNKS_ACROSS: 4,
                    PARTS_ACROSS: 1,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `,

                    STORAGE: randomConwayRGBs

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },
        // 7 (SEVEN) - Mouse movement 
            () => {
                let computeWGSL = 
                `

                    // Helper variables for readability later on
                    var attributeOffset: u32 = 0;
                    var myState: f32 = 0;
                    var totalNghbrCount: u32 = 0;

                    // Loop through each value in the cell, and store their CGOL state value
                    var neighbrs: array< f32, EZ_CELL_VALS >;
                    var valIndex: u32 = 0;
                    loop {
                        if valIndex >= EZ_CELL_VALS { break; }
                        
                        neighbrs[ valIndex ] = 0f;
                        attributeOffset = valIndex*EZ_TOTAL_CELLS;

                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );      
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY  , valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );      
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX+1, EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );     
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX  , EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );    
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY-1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );   
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY  , valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );     
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX-1, EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );  
                        neighbrs[ valIndex ] += EZ_GET_CELL( EZX  , EZY+1, valIndex, EZ_CHUNK_X, EZ_CHUNK_Y );

                        myState = EZ_STATE_IN[ EZ_CELL_IND + attributeOffset ];
                        totalNghbrCount = u32(neighbrs[ valIndex ]);

                        // Implement CGOL rules for this value in memory
                        if (myState == 1 && (totalNghbrCount < 2 || totalNghbrCount > 3)) {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = 0.0;
                            neighbrs[ valIndex ] = 0.0;
                        }
                        else if (myState == 0 && totalNghbrCount == 3) {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = 1.0;
                            neighbrs[ valIndex ] = 1.0;
                        }
                        else {
                            EZ_STATE_OUT[ EZ_CELL_IND + attributeOffset ] = myState;
                            neighbrs[ valIndex ] = myState;
                        }
                        
                        valIndex++;
                    }



                    // Here's the addition of mouse handling 
                    //      'incrementer' variable for each f32 or u32 value in memory
                    var i_EZ_userInputCounter: u32 = 0u;
                    loop {
                        if i_EZ_userInputCounter >= EZ_CELL_VALS { break; }

                        let EZ_lastInputToChange         = EZ_TOTAL_CELLS * i_EZ_userInputCounter + EZ_CELL_IND;  
 
                        // Get the min max of the input coordinattres
                        var minX: u32 = min( u32(EZ_USER_INPUT[0]),  u32(EZ_USER_INPUT[2]));
                        var maxX: u32 = max( u32(EZ_USER_INPUT[0]),  u32(EZ_USER_INPUT[2]));
                        var minY: u32 = min( u32(EZ_USER_INPUT[1]),  u32(EZ_USER_INPUT[3]));
                        var maxY: u32 = max( u32(EZ_USER_INPUT[1]),  u32(EZ_USER_INPUT[3]));
                        if( EZ_USER_INPUT[6] > 0 ){
                            if( EZX >= minX && EZX <= maxX && EZY >= minY && EZY <= maxY ){
                                EZ_STATE_OUT[ EZ_lastInputToChange ] = 1; 
                            }
                            else{
                                EZ_STATE_OUT[ EZ_lastInputToChange ] = neighbrs[ i_EZ_userInputCounter ]; 
                            }
                        }
                        else{
                            EZ_STATE_OUT[ EZ_lastInputToChange ] = neighbrs[ i_EZ_userInputCounter ]; 
                        }
                        i_EZ_userInputCounter++;
                    } 


                    
                `;

                let fragmentWGSL = 
                `
                    var rrr: f32 = 0;
                    var ggg: f32 = 0;
                    var bbb: f32 = 0;

                    // Helper variables for readiblity
                    var drawingWeightsOffset: u32 = 0;
                    var cellVal: f32 = 0;
                    var totalTypesLive: u32 = EZ_CELL_VALS;
                    
                    var valIndex: u32 = 0;  //< - the attribute index in a cell
                    loop {
                        if valIndex >= EZ_CELL_VALS { break; }

                        // shift read location in storage buffer: 3 storage values for r,g,b
                        drawingWeightsOffset = EZ_CHUNK_IND * 3u;
                        // and also shift down the location to accomodate the multiple values per cell  
                        drawingWeightsOffset = drawingWeightsOffset + (EZ_CELL_VALS * 3u) * valIndex;

                        // Get the value
                        cellVal = cellState[ EZ_REBUILT_INSTANCE + valIndex * EZ_TOTAL_CELLS ];
                        if( cellVal < 1 ){
                            totalTypesLive = totalTypesLive - 1;
                        }
                        else{ 
                            rrr += EZ_STORAGE[ drawingWeightsOffset + 0 ];
                            ggg += EZ_STORAGE[ drawingWeightsOffset + 1 ];
                            bbb += EZ_STORAGE[ drawingWeightsOffset + 2 ]; 
                        }
                        valIndex++;
                    }

                    if( totalTypesLive < 1 ){
                        rrr = 0;
                        ggg = 0;
                        bbb = 0;
                    }
                    else{
                        rrr = rrr / f32(totalTypesLive);
                        ggg = ggg / f32(totalTypesLive);
                        bbb = bbb / f32(totalTypesLive);
                    }

                    EZ_OUTPUT.red = rrr;
                    EZ_OUTPUT.grn = ggg;
                    EZ_OUTPUT.blu = bbb;
                `;

                // An Extra buffer of random f32's 0-1 to get a variety of colours
                let randomConwayRGBs = new Float32Array( 4096 );
                EZWG.SHA1.seed('test seed 1234' + Date.now());
                for(let b = 0;b < randomConwayRGBs.length;b++){
                    randomConwayRGBs[b] = EZWG.SHA1.random()
                }
                document.getElementById('extraTitle').innerHTML = 'Click and drag to interact with simulation'

                // Usage example
                let config = {

                    CELL_VALS: 12,   // Now this means 17 f32 values per cell
                    CELL_SIZE: 4,
                    CHUNK_SIZE: 32,
                    CHUNKS_ACROSS: 4,
                    PARTS_ACROSS: 1,

                    CONTAINER_ID:   'demoCanvasContainer',    // DOM id to insdert canvas to
                    RAND_SEED:      'randomseed12345678910', 
                    STARTING_CONFIG: EZWG.ALL_BINS,      // couldve been EZWG.ALL_ZERO
                    COMPUTE_WGSL: `
                        // The custom WGSL code goes here
                        ${computeWGSL}
                    `,

                    FRAGMENT_WGSL: `
                        // The custom WGSL code goes here
                        ${fragmentWGSL}
                    `,

                    STORAGE: randomConwayRGBs

                };

                // Intital set the default runner to this
                EZ_EXAMPLE = new EZWG( config);
            },
            
        ];
        

        function loadExample( exampleIndex ){

            clearExample();
            // Initial load the first one
            ALL_EXAMPLES[exampleIndex]();

            (async () => {
                await EZ_EXAMPLE.init(); 
                console.log('EZ_EXAMPLE has been initialized'); 
                startExampleLoop()
            })();

        }
        function clearExample(){
            document.getElementById('extraTitle').innerHTML = '';
            if( INTERVAL_ID ){
                clearInterval( INTERVAL_ID )
            }
            if( EZ_EXAMPLE ){
                EZ_EXAMPLE.killdeath()
            }
        } 
        function startExampleLoop(){
		    INTERVAL_ID = setInterval( () => {
                if( !EZ_EXAMPLE.suicide ){
                    EZ_EXAMPLE.run() 
                } 
            }, EZ_EXAMPLE.UPDATE_INTERVAL ); 
        }


        clearExample();
        loadExample(0)


    </script>
</body>

</html>